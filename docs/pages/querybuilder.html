
<!DOCTYPE html>
<html>
<head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Ness PHP Framework | Documentation</title>
        <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="../assets/css/style.css"> 
        <!--Load highlightjs package -->
        <link rel="stylesheet" href="../assets/js/highlightjs/styles/atom-one-dark.css">
        <script src="../assets/js/highlightjs/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>      
</head>
<body>
    
<!-- Navigation -->
<nav class="navbar navbar-expand-lg fixed-top bg-light bg-white kb" style="z-index: 1;">
        <div class="container">
            <a class="navbar-brand" href="../index.html">
                <img src="../assets/images/ness_logo.png" title="Ness PHP Framework Documentation" >
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"><i class="fas fa-bars"></i></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link account-link" href="../index.html">Home</a>
                </li>  
                
                <li class="nav-item">
                    <a class="nav-link account-link" href="https://www.github.com/nessphp" target="_blank">GitHub</a>
                    </li>  
    
                    <li class="nav-item">
                    <a class="nav-link account-link" href="https://nessphp.github.io/" target="_blank">Ness PHP</a>
                    </li>  
            </ul>
        </div>
        </div>
    </nav>
<!-- [][][] CONTENTS STARTS HERE [][][] -->
<div class="main-contents">
        <!-- SEARCH AREA -->
        <br>
        <div class="row">
            <div class="col-md-7">   
                
                    <div class="nav-board">
                        <a href="../index.html">Documentation</a> >  Query Builder
                    </div>
            </div>
            <div class="col-md-5">
                <!-- EMPTY -->
            </div>
        </div>
        <br><br><br>
        <div class="container">
            <!-- --------------------- EDIT HERE--------------------- -->
            
            <div class="row">
                <div class="col-md-4">

                    <div class="card bg-dark text-white">
                        <div class="card-header">Required Namespace</div>
                        <div class="card-body" >
                            <ul class="tree">
                                <li style="color:#28A745;">Ness
                                    <ul>
                                        <li style="color:#28A745;">Autopulse
                                            <ul><li style="color:#28A745;">Factory
                                                <ul><li style="color:#fff">QueryBuilder</li></ul>
                                            </li></ul>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                            <hr>
                            <span><small>You can include this library to your code file by typing the below code;</small></span>
                            <br><br>
                            <span style="color:#3490CF;">use</span> 
                            <span style="color:#28A745;">Ness\Autopulse\Factory</span>\QueryBuilder
                            
                        </div> 
                    </div>
                    <br><br>
                </div>

                <!-- docs:start-->
                <div class="col-md-8">
                    <br>
                    <h3 style="font-weight: lighter;">Query Builder</h3>
                    <hr>
                    <br>
                    <br><br>

                    <br>
                    <div class="alert alert-info">
                        <strong>Database Connection </strong> All methods and commands in this library requires an active database connection to be runned. You can define your connection witg MySqlConnect or DbConnect class. You can read more about
                        connecting a database <a href="mysql.html">Here </a> or <a href="dbconnect.html">Here </a></span>
                    </div>


                    <ol class="hash-toc">
                            <li><a href="#pagedescription">Query Builder Class</a></li>
                            <li><a href="#simple_1">A Simple Query</a></li>
                            <li><a href="#simple_2">Select Multiple Columns</a></li>
                            <li><a href="#where_1">Get Specific Data</a></li>
                            <li><a href="#where_2">Get Specific Data with Multiple Conditions</a></li>
                            <li><a href="#where_3">Using where_or</a></li>
                            <li><a href="#like">Searching Data With 'like' methods</a></li>
                            <li>Wildcard Options
                                <ol class="hash-toc">
                                        <li><a href="#wildcard_position">Wildcard Position</a></li>
                                        <li><a href="#special_wildcard">Special Wildcard</a></li>
                                </ol>
                                
                            </li>
                            <li><a href="#joins">Using JOIN's</a></li>
                            <li><a href="#group_by">group_by</a></li>
                            <li><a href="#order_by">order_by</a></li>
                            <li><a href="#limit">limit</a></li>
                        
                            <li>Other Useful Commands
                                <ol class="hash-toc">
                                        <li><a href="#sum">sum</a></li>
                                        <li><a href="#min">min</a></li>
                                        <li><a href="#max">max</a></li>
                                        <li><a href="#avg">avg</a></li>
                                        <li><a href="#count">count</a></li>
                                        <li><a href="#distinct">distinct</a></li>
                                        <li><a href="#column_as">column_as</a></li>
                                        <li><a href="#free">free</a></li>
                                        <li><a href="#frontfree">frontfree</a></li>
                                        <li><a href="#endfree">endfree</a></li>
                                </ol>
                                
                            </li>
                    
                            <li><a href="#running">Running Generated Queries</a></li>
                        </ol>
                        <br>
                        <!-- CONTENT START -->
                    
                        <br><br>
                        <h3 id="pagedescription">Query Builder Class</h3>
                        <p>
                        Query Builder class is used to generate queries and retrieve records from your database. Using a query builder class will give you a more understandable code, you will have a chance to access your records with few lines rather than creating and thinking on complex queries. You can run your 'select' queries using this library for 'update' and 'insert' commands you need to use 'Autopulse' library. You can take a look at <a href="autopulse.html">Autopulse Library Here.</a>
                        <br>
                        
                    
                        </p>
                    
                    
            
                    <hr>
                    
                    <div class="alert alert-warning">
                                      <strong>About Queries </strong> All your queries must end with <span class="ug-keyword ug-code">get()</span> function. This is required for returning your current query. </span>
                                    </div>
                    
                    
                    <br><br>
                        <h3 id="simple_1">A Simple Query</h3>
                        <p>
                            Following code example show's you how to select all data from a table.
                            <pre>
                                <code class="php">
$qb = new QueryBuilder();
$mycommand = $qb->select()
            ->table("members")
            ->get();
            
//Generated: select  * from members
                                </code>
                            </pre>
                        
                        </p>
                    <br><br>
                    
                    
                    
                    <br><br>
                        <h3 id="simple_2">Select Multiple Columns</h3>
                        <p>
                            This example is about chained selects for multiple columns. You can do the same task by using arrays. The following second example
                            will show you how to use arrays.
                    <pre>
                        <code class="php">
$qb = new QueryBuilder();
$mycommand = $qb->select("email")->select("password")
            ->table("members")
            ->get();
            
    //Generated: select  email, password from members
                                
                        </code>
                    </pre>
                    <br> <br>
                    The same thing can be done with arrays.
<pre>
    <code class="php">
$qb = new QueryBuilder();
$mycommand = $qb->select(array("username", "email", "password"))
                ->table("members")
                ->get();
            
//Generated: select   username, email, password from members


//or you can use
$mycommand = $qb->select("username, email, password")->table("users")->get();

//This will generate: select   username, email, password from users
            
    </code>
</pre>
                        
                        </p>
                    <br><br>
                    
                    
                    
                    
                    
                    <br><br>
                        <h3 id="where_1">Get Specific Data</h3>
                        <p>
                            Following code example show's you how to select a specific data from a table.
<pre>
    <code class="php">
$mycommand = $qb->select("username")
    ->table("users")
    ->where("id=", "1955")
    ->get();
//Generated: select  username from users  where id ='1955'

    </code>
</pre>
                        
                        </p>
                    <br><br>
                    
                    <br><br>
                        <h3 id="where_2">Get Specific Data with Multiple Conditions</h3>
                        <p>
                            You can use chained where function or array for multiple conditions. These two code lines will show you an example about
                            that.
<pre><code class="php">
$qb = new QueryBuilder();
$mycommand = $qb->select("username")
    ->table("users")
    ->where("age >=", "18")->where("country_code=", "32")
    ->get();
//Generated: select  username from users  where age >='18'  AND country_code='32'
</code>

</pre>
                    <br>
                    The following code lines will return same result.
                        
                    
    <pre>
        <code class="php">
$qb = new QueryBuilder();
$mycommand = $qb->select("username")
        ->table("users")
        ->where(array("age >=" => "18", "country_code=" => "32"))
        ->get();
//Generated: select  username from users  where age >='18'  AND country_code='32'
        </code>

</pre>
                        </p>
                    <br><br>
                    
                    
                    
                    <br><br>
                        <h3 id="where_3">Using where_or</h3>
                        <p>
                            This function is for where condition with OR
<pre>
    <code class="php">
$qb = new QueryBuilder();
$mycommand = $qb->select("username")
        ->table("users")
        ->where_or("age >=", "18")->where("country_code=", "32")
        ->get();
//Generated: select  username from users  where age >='18'  OR country_code='32'
    </code>

</pre>
                    <br>
                    The following code lines will return same result.
                        
                    
<pre>
    <code class="php">
$qb = new QueryBuilder();
$mycommand = $qb->select("username")
        ->table("users")
        ->where_or(array("age >=" => "18", "country_code=" => "32"))
        ->get();
//Generated: select  username from users  where age >='18'  OR country_code='32'
    </code>
</pre>

                    <br>
                    You can connect where with where_or:
                    <br>
<pre>
<code class="php">
$qb = new QueryBuilder();
$mycommand = $qb->select("*")
    ->table("users")
    ->where("id >","10")->where_or(array("country_code="=>"10"))->where("gender=","m")
    ->get();
//Generated: select  * from users  where id >'10'  OR  country_code='10'   AND gender='m'
</code>
</pre>
                        </p>
                    <br><br>
                        
                    
                    
                    <br><br>
                        <h3 id="like">Searching Data With 'like' methods </h3>
                        <p>
                            You can generate queries with LIKE condition.
<pre>
    <code class="php">
$qb = new QueryBuilder();
$mycommand = $qb->select(array("product_name", "author", "version"))
        ->table("products pr")
        ->like("product_name", "nessphp")
        ->get();
//Generated: select   product_name, author, version from products pr  WHERE product_name LIKE  '%nessphp%'
    </code> 
</pre>
                    <br>
                    
                    You can also use this method with chained methods.
                    
<pre>
<code class="php">
$qb = new QueryBuilder();
$mycommand = $qb->select(array("pr.product_name", "pr.author", "pr.version"))
        ->table("products pr")
        ->like("pr.product_name", "nessphp")->like("author","Sinan")
        ->get();
//Generated: select   pr.product_name, pr.author, pr.version from products pr  
//WHERE pr.product_name LIKE  '%nessphp%' AND author LIKE  '%Sinan%'
</code>
</pre>
                    <br><br>
                    
                    <div class="alert alert-info">
                        <strong>Setting Wildcard Options</strong> As you have noticed, the wildcard in the like method is found both at the beginning and at the end.
                    You can set this with some special functions. The following code should be followed for this.
                    </div>
                    
                    <h4 id="wildcard_position">Wildcard Position</h4>
<pre>
    <code class="php">
$mycommand = $qb->select("product_name")
->table("products")
->like("author", "Sinan", $qb->wildcard->Both())
->get();
//Generated:  ..... author LIKE  '%Sinan%'
    </code>
</pre>

                    <b>Front: $qb->wildcard->Front()</b>
                    <pre>
                        <code class="php">
                            
$mycommand = $qb->select("product_name")
->table("products")
->like("author", "Sinan", $qb->wildcard->Front())
->get();
//Generated:  ..... author LIKE  '%Sinan'
                        </code>
                    </pre>
                    <b>End: $qb->wildcard->End()</b>
                    <pre>
                        <code class="php">
                            
$mycommand = $qb->select("product_name")
->table("products")
->like("author", "Sinan", $qb->wildcard->End())
->get();
//Generated:  ..... author LIKE  'Sinan%'
                        </code>
                    </pre>
                    <br>
                    
                    You can also set a special wildcard charecter for LIKE clause. You can do that by;
                    <br>
                    
                    <h4 id="special_wildcard">Special Wildcard</h4>
                    <pre>
<code class="php">
$qb = new QueryBuilder();

$qb->wildcard->setWildcard("_");
$mycommand = $qb->select("product_name")
->table("products")
->like("author", "Sinan", $qb->wildcard->End())
->get();
</code>
                    </pre>
                    Running command with <span class="ug-code ug-bold ug-folder">$qb->wildcard->setWildcard("_");</span> will set your <span class="ug-code ug-bold ug-keyword">%</span> to <span class="ug-code ug-keyword ug-bold">_</span> wildcard.
                    <br><br>
                    You can get your current wildcard by calling  <span class="ug-code ug-bold ug-folder">$qb->wildcard->getWildcard();</span> this will return as string your current wildcard.
                    <br>
                    
                    <h4 id="liketypes">Other types of LIKE </h4>
                    You can also call the LIKE method with some other customized methods. Here is a list of them;
                    
                    <br><br>
                    <span class="ug-code ug-keyword ug-bold">like_not</span>: The use of this method is identical to LIKE. The only difference between them is the function. like_not method creates queries with NOT restriction.
                    <br><br>
                    
                    <span class="ug-code ug-keyword ug-bold">like_or</span>: Standart 'like' method will connect conditions with 'AND' if you want to add a OR condition you need to call your 'like' method with this 'like_or' method.
                    <br><br>
                    
                    <span class="ug-code ug-keyword ug-bold">like_or_not</span>: Standart 'like_not' method will connect conditions with 'AND' if you want to add a OR condition you need to call your 'like_not' method with this 'like_or_not' method.
                    <br><br>
                        </p>
                    
                    
                    <div class="alert alert-info"> 
                        <strong>INFO</strong> 
                        <span>All your wildcard options can be used in all types or like methods </span>
                    </div>
                    
                    </p>
                    
                    
                    <h3 id="joins">Using JOIN's</h3>
                    <p>
                        by default your queries with JOIN should be;
                    
                    <pre><code class="php">
$qb = new QueryBuilder();
$mycommand = $qb->select("u.username")
        ->table("users u")
        ->join("roles r", "r.roleid = u.roleid")
        ->get();
        </code>
                    </pre>
                    
                    <b>Or you can connect multiple joins with each other</b>
                    
                    <pre> <code class="php">
$qb = new QueryBuilder();
$mycommand = $qb->select("u.username, m.message")
        ->table("users u")
        ->join("roles r", "r.roleid = u.roleid")
        ->join("mesaages m", "m.userid = u.userid")
        ->get();
    </code>
                    </pre>
                    
                    
                    <div class="alert alert-info">
                        <strong>JOIN TYPES</strong>
                        You can set a join type by adding a third parameter to your join method in your query. For example you can set it "INNER", "OUTER","RIGHT" or "LEFT"
                    </div>
                    </p>
                    <b>Example: </b>
                    
<pre><code class="php">
$qb = new QueryBuilder();
$mycommand = $qb->select("u.username, m.message")
        ->table("users u")
        ->join("roles r", "r.roleid = u.roleid", <span class="ug-keyword ug-bold">"INNER"</span>)
        ->join("mesaages m", "m.userid = u.userid",  <span class="ug-keyword ug-bold">"INNER"</span>)
        ->get();
    </code>
                    </pre>
                    
                    
                    <br>
                    <h3 id="group_by">group_by</h3>
                    <p>
                    Add a group by condition to your query
                    <pre><code class="php">
$qb = new QueryBuilder();
$mycommand = $qb->select("message_type, message_body")
        ->table("messages")
        ->group_by("message_type")
        ->get();
        </code>
</pre>
                    
                    <br>
                    <pre><code class="php">
$qb = new QueryBuilder();
$mycommand = $qb->select("message_type, message_body")
    ->table("messages")
    ->group_by(array("message_type", "other_1", "other_2", ... , "other_n")
    ->get();
    </code>
                    </pre>
                    </p>
                    
                    <br>
                    <h3 id="order_by">order_by</h3>
                    <p>
                    Set aorder by condition to your query
                    <pre><code class="php">
$qb = new QueryBuilder();
$mycommand = $qb->select("message_type, message_body")
        ->table("messages")
        ->order_by("message_date", "ASC")
        ->get();
    </code>
                    </pre>
                    </p>
                    
                    
                    <br>
                    <h3 id="limit">limit</h3>
                    <p>
                    Add LIMIT condition to your query
                    <pre><code class="php">
$qb = new QueryBuilder();
$mycommand = $qb->select("message_type, message_body")
        ->table("messages")
        ->order_by("message_date", "ASC")
        ->limit(20)
        ->get();</code>
                    </pre>
                    </p>
                    
                    
                    <br>
                    
                    <h3 id="others">Other Useful Commands</h3>
                    <p>
                    
                    <h4 id="sum">sum()</h4>
                    <pre><code class="php">
$qb = new QueryBuilder();
$mycommand = $qb->select(QueryBuilder::sum("salary"))
        ->table("employee")
        ->get();
//select   SUM(salary)  from employee
</code>
                     </pre>
                    </p>
                    
                    <h4 id="min">min()</h4>
                    <pre><code class="php">
$qb = new QueryBuilder();
$mycommand = $qb->select(QueryBuilder::min("salary"))
        ->table("employee")
        ->get();
//select   MIN(salary)  from employee</code>
                     </pre>
                    </p>
                    
                    <h4 id="max">max()</h4>
                    <pre><code class="php">
$qb = new QueryBuilder();
$mycommand = $qb->select(QueryBuilder::max("salary"))
        ->table("employee")
        ->get();
//select   MAX(salary)  from employee</code>
                     </pre>
                    </p>
                    
                    <h4 id="avg">avg()</h4>
                    <pre><code class="php">
$qb = new QueryBuilder();
$mycommand = $qb->select(QueryBuilder::avg("salary"))
        ->table("employee")
        ->get();
//select   AVG(salary)  from employee</code>
                     </pre>
                    </p>
                    
                    <h4 id="count">count()</h4>
                    <pre><code class="php">
$qb = new QueryBuilder();
$mycommand = $qb->select(QueryBuilder::count("*"))
        ->table("employee")
        ->get();
//select   count(*)  from employee</code>
                     </pre>
                    </p>
                    
                    <h4 id="distinct">distinct()</h4>
                    <pre><code class="php">
$qb = new QueryBuilder();
$mycommand = $qb->select(QueryBuilder::distinct("user_name"))
        ->table("employee")
        ->get();
//select   distinct user_name  from employee</code>
                     </pre>
                    </p>
                    
                    
                    <h4 id="column_as">column_as()</h4>
                    <pre><code class="php">
$qb = new QueryBuilder();
$mycommand = $qb->select(QueryBuilder::column_as("u.username", "fullName"))
        ->table("employee")
        ->get();
//select u.username AS fullName from employee</code>
                     </pre>
                    </p>
                    
                    
                    <h4 id="free">free()</h4>
                    Returns the value in parameter.
                    <pre><code class="php">
QueryBuilder:free("select * from users");</code>
                     </pre>
                    </p>
                    
                    
                    <h4 id="frontFree">frontfree()</h4>
                    <pre><code class="php">
$qb = new QueryBuilder();

$qb->frontFree("-- DISABLED");
$mycommand = $qb->select(QueryBuilder::column_as("u.username", "fullName"))
        ->table("employee")
        ->get();
// -- DISABLED select u.username AS fullName from employee</code>
                     </pre>
                    </p>
                    
                    
                    <h4 id="endfree">endfree()</h4>
                    <pre><code class="php">
$qb = new QueryBuilder();

$qb->endFree("-- THIS QUERY SELECTS ALL RECORDS FROM employee TABLE");
$mycommand = $qb->select(QueryBuilder::column_as("u.username", "fullName"))
        ->table("employee")
        ->get();
//select u.username AS fullName from employee -- THIS QUERY SELECTS ALL RECORDS FROM employee TABLE</code>
                     </pre>
                    
                    
                    <h3 id="running">Running Generated Queries</h3>
                    <p>
                        All methods and returned values in QueryBuilder class is stored in a variable and send to any variable or parameter as string.
                        For running a query generated with QueryBuilder class you need to define a connection to database. This example will guide you to
                        create a simple query and run it with mysqlconnect and mysqlcommand class.
                    <br>
                    <pre><code class="php">

//Create a query builder instance
$qb = new QueryBuilder();

//create a command
$mycommand = $qb->select(array("u.email", 
    QueryBuilder::column_as(QueryBuilder::free("concat_ws(' ', u.name, 'u.surname')"), "fullName")))
->table("employee")
->get();


//define connection
$con = new MySqlConnect("localhost", "root", "my_pwd_324234", "employee");

//fill command to MySqlCommand class
$cmd = new MySqlCommand($mycommand, $con->Source());

//returned data as array in var_dump
var_dump($cmd->FetchAll());</code>
                    </pre>
                    </p>

                    <br><br>

            
                </div>
                <!-- docs:end -->


            </div>


            <!-- [/] ------------------- EDIT HERE------------------- -->
        </div>

        <br><br><br>
        <div class="text-center">
            <span>&copy; Ness PHP Framework <span id="the-x">Ness</span> | All Rights Reserved</span>
            <br><br>
        </div>
    </div>  
    <!-- [/][/][/] CONTENTS ENDS HERE [][][] --> 

</body>
</html>